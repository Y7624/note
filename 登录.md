## 登录

![image-20250716133205432](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716133205432.png)

![image-20250716134339262](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716134339262.png)

### 会话技术

会话：用户打开浏览器，访问web服务器的资源，会话建立，直到有一方断开连接，会话结束。在一次会话中可以包含多次请求和响应

会话跟踪：一种维护浏览器状态的方法，服务器需要识别多次请求是否来自同一浏览器，以便在同一次会话的多次请求间共享数据

会话跟踪方案：

  客户端会话跟踪技术：Cookie

  服务端会话跟踪技术：Session

令牌技术

![image-20250716141550105](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716141550105.png)

Cookie:

优点：HTTP协议中支持的技术

缺点：移动端APP无法使用Cookie

​          不安全，用户自己禁用Cookie

​        Cookie不能跨域



协议区分三个维度：协议、IP/域名、端口

![image-20250716143137776](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716143137776.png)

优点：存储在服务端，安全

缺点：服务器集群环境下无法直接使用Session

​           Cookie的缺点

![image-20250716145048384](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716145048384.png)

优点：

支持PC端、移动端

解决集群环境下的认证问题

减轻服务器端存储压力

缺点：需要自己实现

### JWT令牌

JWT：定义了一种简洁的、自包含的格式，用于在通信双方以json数据格式安全的传输信息。由于数字签名的存在，这些信息是可靠的

组成

第一部分：Header（头），记录令牌类型、签名算法等

第二部分：Payload（有效载荷），携带一些自定义信息、默认信息等

第三部分：Signature（签名），防止Token被篡改、确保安全性。将header\payload，并加入指定密钥，通过指定签名算法计算而来

Base64:是一种基于64个可打印字符（A-Z a-z 0-9 + /)来表示二进制数据的编码方式

#### 登录认证

1.登录成功后：生成令牌

2.后续每个请求，都要携带JWT令牌，系统在每次请求处理之前，先检验令牌，通过后，再处理

![image-20250716150907214](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716150907214.png)

Jwt校验时使用的签名密钥，必须和生成jwt令牌时使用的密钥是配套的

如果jwt令牌解析校验时报错，则说明jwt令牌被篡改或失效了，令牌非法

### 过滤器（filter）

filter过滤器，是javaweb三大组件（Servlet、Filter、Listener)之一

过滤器可以把对资源的请求拦截下来，从而实现一些特俗的功能

过滤器一般完成一下通用的操作，比如：登录校验、统一编码处理、敏感字符处理等

![image-20250716210915919](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250716210915919.png)

过滤器链：在一个web应用中，可以配置多个过滤器，这多个过滤器就形成了一个过滤器链

顺序：注解配置的Filter，优先级是按照过滤器类名（字符串）的自然排序

![image-20250717123818016](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250717123818016.png)

![image-20250717124833031](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250717124833031.png)

### 拦截器

概念：是一种动态拦截方法调用的1机制，类似于过滤器。Spring框架中提供的，用来动态拦截控制器方法的执行

作用：拦截请求，在指定的方法调用前后，根据业务需要执行预先设定的代码

![image-20250717140027019](C:\Users\45379\AppData\Roaming\Typora\typora-user-images\image-20250717140027019.png)

**filter与interceptor**

接口规范不同：过滤器需要实现filter接口，而拦截器需要实现HandlerInterceptor接口

拦截范围不同：过滤器filter会拦截所有的资源，而Interceptor只会拦截spring环境中的资源